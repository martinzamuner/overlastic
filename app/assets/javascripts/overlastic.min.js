addEventListener("click",(e=>{window._overlasticInitiator=e.target}),!0),addEventListener("click",(e=>{const t=window._overlasticInitiator?.closest("a[data-overlay-name]");t&&t.removeAttribute("target")}),!0),addEventListener("turbo:before-fetch-request",(e=>{e.detail.fetchOptions.headers["Overlay-Enabled"]="1"})),addEventListener("turbo:before-fetch-request",(e=>{const t=window._overlasticInitiator?.closest("a[data-overlay-name]"),a=t?.dataset?.overlayName,r=t?.dataset?.overlayType,s=t?.dataset?.overlayTarget,i=t?.dataset?.overlayArgs;t&&(e.detail.fetchOptions.headers["Overlay-Initiator"]="1",e.detail.fetchOptions.headers["Overlay-Name"]=a,r&&(e.detail.fetchOptions.headers["Overlay-Type"]=r),s&&(e.detail.fetchOptions.headers["Overlay-Target"]=s),i&&(e.detail.fetchOptions.headers["Overlay-Args"]=i))})),addEventListener("turbo:before-fetch-request",(e=>{const t=document.querySelector("script[overlay]");if(t){const a=document.querySelector(`overlastic[id=${t.getAttribute("overlay")}]`);if(a){const t=a.id,r=a.dataset.overlayTarget,s=a.dataset?.overlayType,i=a.dataset?.overlayArgs;e.detail.fetchOptions.headers["Overlay-Name"]=t,e.detail.fetchOptions.headers["Overlay-Target"]=r,e.detail.fetchOptions.headers["Overlay-Initiator"]="1",s&&(e.detail.fetchOptions.headers["Overlay-Type"]=s),i&&(e.detail.fetchOptions.headers["Overlay-Args"]=i)}}})),addEventListener("turbo:before-fetch-request",(e=>{const t=window._overlasticInitiator?.closest("a, form"),a=t?.closest("overlastic");if(a&&!t.dataset.overlay&&!t.dataset.overlayName){const t=a.id,r=a.dataset.overlayTarget,s=a.dataset?.overlayInitiator,i=a.dataset?.overlayType,o=a.dataset?.overlayArgs;e.detail.fetchOptions.headers["Overlay-Name"]=t,e.detail.fetchOptions.headers["Overlay-Target"]=r,s&&(e.detail.fetchOptions.headers["Overlay-Initiator"]=s),i&&(e.detail.fetchOptions.headers["Overlay-Type"]=i),o&&(e.detail.fetchOptions.headers["Overlay-Args"]=o)}delete window._overlasticInitiator})),Turbo.StreamActions.replaceOverlay=function(){let e=[],t=0;const a=this.targetElements[0],r=a.id,s=()=>{if(t++,t>=e.filter((e=>!1===e)).length){Turbo.StreamActions.replace.bind(this)();const e=document.getElementById(r),t=e.firstElementChild||e,a=new Event("overlastic:connect",{bubbles:!0,cancelable:!1});t.dispatchEvent(a)}};e=[a,...a.querySelectorAll("overlastic")].map((e=>{const t=e.firstElementChild||e,a=new CustomEvent("overlastic:disconnect",{bubbles:!0,cancelable:!0,detail:{resume:s}});return t.dispatchEvent(a)})),e.every((e=>!0===e))&&s()};
//# sourceMappingURL=overlastic.min.js.map
